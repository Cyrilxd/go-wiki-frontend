addons:
  apt:
    packages:
    - nasm
env:
  global:
  - DOCKER_REPO=rootlogin/go-wiki-frontend
  - secure: g6t4enwaAHpu6UXYEZ9Hf8ekJTBUKyCMI9b378iGuoVzDSSVs4+8f8hNB1YcTie2eXqXmhwO/fvYoO6I9vCuxNstQ94jHIpobqUMwPeA/oHOErmWVulM9raqNfQn02I4Jv+wshYNoKlictqwTJkKoO2pPZnjWUkGupUcVvkG90ohXt6fT6L7a+JsBUnvSg17PgNsYjE+MvZzpyty4GoOVgzgq+jrjcg5nX2o3UQncayd3DcArypM4Qss0OkS1akCUqsSa/J66W6J9q+f7kl/qDm3ReUJoClcDWK9MqPfl+G7IHRsgzZ8x71OywblnaJK6P89GRoz7GtiHiVwCQDaB/7EJtBTahlbfvcgv7DfCrzw9l5DjuNufK+j+iw6PBgB8gqq1VY8beO+fnA00vz/MpDidLtH7Vj6KrQ/cUNIrdnVwQ37KBXFCyiDlpfPF+4yxu8ScVQVkP07ODTS1oApW/fb3XpIcunToVUEuQepSG7f2ZhgH4IpLe/9WkZq5VTxfsLGyas4fbXKxdUX5W+1MWwN7tKtmydnttrVioqHS0AOk8coxWSzHfrhJNUn2WEFNSGZARf6kbndVN7cG20WlrySEDsUreW9QVjt4LVXB6kEziviuopgSAVUSRx9H8y4rvizb3fvKPljh5lpNtX8bE5xPTllHVc1LnJZbyzbflw=
jobs:
  include:
  - language: go
    go: 1.10.x
    node_js: lts/*
    cache:
      directories:
      - node_modules
      - vendor
    before_script:
    - npm install -g npm
    - curl https://raw.githubusercontent.com/golang/dep/master/install.sh | sh
    - go get -u github.com/go-bindata/go-bindata/...
    install:
    - 
    script:
    - make web_app go_plugin
    after_success:
    - curl -T frontend_plugin -urootlogin:$BINTRAY_API_KEY https://api.bintray.com/content/go-wiki/go-wiki-plugins/frontend/$TRAVIS_BRANCH/frontend_plugin
  - sudo: required
    services:
    - docker
    script:
    - export TAG=`if [[ $TRAVIS_PULL_REQUEST == "false" ]] && [[ $TRAVIS_BRANCH ==
      "master" ]]; then echo "latest"; else echo $TRAVIS_PULL_REQUEST_BRANCH; fi`
    - docker build -t $DOCKER_REPO:$TAG .
